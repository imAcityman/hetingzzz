<div class="write" (click)="writeMessage('写点什么吧 ...')">留下印记</div>
<div class="mask-layer" [ngClass]="{'hide':!isWrite}" (click)="hideWrite()"></div>

<PullToRefresh
  *ngIf="messageList && messageList.length > 0"
  [ngStyle]="{height: '100%'}"
  [direction]="'down'"
  [(ngModel)]="refresh"
  [endReachedRefresh]="true"
  (onRefresh)="pageLoad($event)"
  [headerIndicator]="{activate: '下拉刷新', release: '刷新中……', finish:'',deactivate:'下拉刷新'}"
  [footerIndicator]="{activate: '更多消息', release: '', finish:'', deactivate:'已经没有更多数据了'}"
>
  <ul class="list">
    <li class="item" *ngFor="let item of messageList">
      <div class="head">
        <img [src]="item.user.imagehead">
      </div>
      <div class="body">
        <div class="name">
          {{ item.user.name}}
        </div>
        <div class="time">
          {{item.createtime|date:'MM月dd日 HH:mm'}}
        </div>
        <p class="content">{{item.content}}</p>
        <ul class="reply" *ngIf="item.replies.length > 0">
          <li *ngFor="let reply of item.replies">
            <p class="reply-body">
              <span (click)="replyMessage(item.id,reply.user.name,reply.user.id)">
                <a class="reply-name">{{reply.user.name}}:</a>
                <a class="reply-name" *ngIf="reply.targetuser">@{{reply.targetuser.name}}</a>
                <span class="reply-content">{{reply.content}}</span>
              </span>
              <a class="blue remove-reply" *ngIf="me == reply.user.id" (click)="deleteMessage(reply.id)">删除</a>
            </p>
          </li>
        </ul>
        <div class="btn-group">
          <a class="btn btn-pink" href="javascript:;" (click)="replyMessage(item.id,item.user.name)">
            <i class="ht-icon icon-message"></i>回复
          </a>
          <a class="btn btn-pink" href="javascript:;" *ngIf="me == item.user.id" (click)="deleteMessage(item.id)">
            <i class="ht-icon icon-delete"></i>删除
          </a>
        </div>
      </div>
    </li>
  </ul>
</PullToRefresh>

<ul class="nomessage" *ngIf="messageList && messageList.length <= 0">
  <li>
    您的留言板空空如也~
  </li>
</ul>


<div class="box" [ngClass]="{'up':isWrite}">
  <form (submit)="submit()">
    <div class="pd">
      <label class="reply-people grey" for="content" *ngIf="replyName">@{{replyName}}</label>
      <textarea id="content" maxlength="200" name="content" [(ngModel)]="message.content"
                [placeholder]="placeholder"></textarea>
      <div class="btn-write">
        <span class="number">{{message.content.length || 0}} / 200</span>
        <button type="submit">留言</button>
      </div>
    </div>
  </form>
</div>

<ng-template #head>
  111111
</ng-template>
